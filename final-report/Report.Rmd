---
title: "STAT225"
author: "Oliver Baldwin Edwards, Leah Johnson, Adi Arifovic"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  pdf_document:
    fig_height: 2.7
    fig_width: 5
  html_document:
    fig_height: 3
    fig_width: 5
  word_document:
    fig_height: 3
    fig_width: 5
---

```{r, setup, include=FALSE}
library(mdsr)   
library(ggplot2)
library(mosaic)
library(knitr)
library(tidyverse)
library(dplyr)
library(GGally)
library(kableExtra)
library(DAAG)
library(Rfit)
library(leaps)
library(gam)
# Load additional packages here 
knitr::opts_chunk$set(
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
```

# Predicting Hurricane Deaths
Group 2: Oliver Baldwin Edwards, Leah Johnson, Adi Arifovic 

*table of contents here*

## Purpose

We hope to predict the log number of hurricane deaths based on variables such as maximum sustained windspeed, atmospheric pressure, and property damage from a dataset containing data on 94 named hurricanes that made landfall in the US mainland from 1950 through 2012. We would expect the number of deaths to increase as the maximum sustained windspeed and property damage increases, since it would make sense for more destructive hurricanes to also be more deadly.

## Data
### Source

We plan to use the dataset "hurricNamed" from the "DAAG" R package containing data on 94 named hurricanes that made landfall in the US mainland from 1950 through 2012. It contains information on the number of deaths, the name of the hurricane, the year of the hurricane, the damage caused by the hurricane, etc. The data is sourced from multiple places and was used in a research paper claiming that hurricanes with female names did more human damage (after adjusting for the severity of the storm) than those with male names. Therefore, the data seems fairly reliable.

### Response Variables 

Our response variable is the log number of deaths that occurred due to a hurricane. The units are number of human deaths. We observe that the range of deaths are from 0 to 1836. 

### Explanatory Variables

The explanatory variables we will examine are LF.WindsMPH, LF.PressureMB, LF.times, BaseDam2014, NDAM2014, and deaths.

\begin{enumerate}
\item LF.WindsMPH describes the maximum sustained windspeed for each hurricane in miles per hour
\item LF.PressureMB describes the atmospheric pressure at landfall in millibars
\item LF.times describes the number of times the hurricane made landfall 
\item BaseDam2014 describes the property damage caused by the hurricane in millions of 2014 US dollars
\item NDAM2014 describes the amount of damage the hurricane caused had it appeared in 2014 (no units given)
\item deaths describes the number of human deaths the hurricane caused
\end{enumerate}

```{r, include=FALSE}
# load in full dataset
full_hurricane_df <- hurricNamed
glimpse(full_hurricane_df)

# remove non numeric and BaseDamage for ggpairs call
hurricane_numeric <- full_hurricane_df %>% 
  select(-c(Name, AffectedStates, firstLF, mf, BaseDamage, Year))

# removing death outlier
hurricane_death_outlier <- hurricane_numeric %>% 
  filter(deaths != 1836)

# applying a log transformation to deaths
hurricane_logdeaths <- hurricane_numeric %>% 
  mutate(log_deaths = ifelse(deaths == 0, 0, log(deaths))) %>% 
  mutate(NDAM2014 = log(NDAM2014)) %>% 
  mutate(BaseDam2014 = log(BaseDam2014)) %>% 
  select(-deaths)
```

## Exploratory Data Analysis

We first look at kernel density estimates of our predictors, and find that adding a `log()` transformation to `deaths`, `NDAM2014`, and `BaseDam2014` give us more normal kernel density estimates and minimize the effects of the outliers. This allows us to fit linear regression models (OLS and JHM) to the data.

```{r, include=FALSE}
ggpairs(hurricane_numeric) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

We proceed and investigate the resulting GGPairs calls on our dataset with the applied log transformations. A few of the resulting KDE's can be seen below:

```{r, include=FALSE}
ggpairs(hurricane_logdeaths) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


## Correlation Tests

We now proceed and run a few correlation tests to investigate the potential for positive associations between different predictors and our response variable. Here we use Kendall's $\tau$ 

Put a sentence explaining that we want kendalls over spearmans since more robust
setup hypothesis test for posstivie association $\tau >0$ 
```{r}
# associated
cor.test(x=hurricane_logdeaths$NDAM2014, y=hurricane_logdeaths$log_deaths, method="kendall")

cor.test(x=hurricane_logdeaths$LF.times, y=hurricane_logdeaths$log_deaths, method="kendall")

cor.test(x=hurricane_logdeaths$LF.PressureMB, y=hurricane_logdeaths$log_deaths, method="kendall")


cor(x=hurricane_logdeaths$NDAM2014, y=hurricane_logdeaths$log_deaths, method="kendall")
```



## OLS 

## Checking Assumption

### KS Test 

## JHM 







